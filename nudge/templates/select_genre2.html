{% extends "layout.html" %}
{% block title %}Select genre{% endblock %}
{% block content %}
    <h3>
        Explore my music taste by genre
    </h3>
        <p class="lead show-on-success">
            Your Spotify profile shows that you like the genre
            <span id="top_genre" class="font-weight-bold">
            </span>
            most. We would like to help you explore a new music genre.
        </p>

        <p class="lead">
            Please select a new music genre from the below list to explore. The list is sorted by
            <span id="sort" class="font-weight-bold"></span>
        </p>

        <div class="show-on-success">
            <!--<h3><span id="default-list" class="badge badge-primary"></span></h3>-->
            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios1" checked>
                <label class="form-check-label lead font-weight-bold" id="label_radio1" for="Radios1">
                </label>
                <span id="exp1" class="badge badge-primary"></span>
            </div>
            <br>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios2">
                <label class="form-check-label lead font-weight-bold" id="label_radio2" for="Radios2">
                </label>
            </div>
            <br>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios3">
                <label class="form-check-label lead font-weight-bold" id="label_radio3" for="Radios3">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios4">
                <label class="form-check-label lead font-weight-bold" id="label_radio4" for="Radios4">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios5">
                <label class="form-check-label lead font-weight-bold" id="label_radio5" for="Radios5">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios6">
                <label class="form-check-label lead font-weight-bold" id="label_radio6" for="Radios6">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios7">
                <label class="form-check-label lead font-weight-bold" id="label_radio7" for="Radios7">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios8">
                <label class="form-check-label lead font-weight-bold" id="label_radio8" for="Radios8">
                </label>
            </div>
            <br>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="genre" id="Radios9">
                <label class="form-check-label lead font-weight-bold" id="label_radio9" for="Radios9">
                </label>
                <span id="exp2" class="badge badge-secondary"></span>
            </div>
            <br>

        </div>

    <br>


    <div class="text-right">
        <a type="submit" class="btn btn-success" id="action_submit" href="#">
            Continue <i class="fas fa-arrow-right"></i>
        </a>
    </div>

{% endblock %}
{% block scripts %}
    <script>
        let condition;
        $.ajax({url:'/genre_suggestion', success: function(result){
            console.log(result);
            condition = {{ condition }}
            if (result === "error"){
                alert("You do not have enough activity on your Spotify account to generate recommendations, " +
                    "therefore you can not participate in the experiment. We still want to thank you for your effort.");
            } else {
                $("#top_genre").text(result[0])
                if (condition >= 3){
                    $("#Radios2").val(result[1]);
                    $("#Radios3").val(result[2]);

                    $("#Radios4").val(result[3]);
                    $("#Radios5").val(result[4]);
                    $("#Radios6").val(result[5]);
                    $("#Radios7").val(result[6]);
                    $("#Radios8").val(result[7]);
                    $("#Radios9").val(result[8]);
                    $("#Radios10").val(result[9]);

                    $("#label_radio2").html(result[1] );
                    $("#exp1").text("the closest genre")
                    $("#label_radio3").html(result[2]);

                    $("#label_radio4").html(result[3]);
                    $("#label_radio5").html(result[4]);
                    $("#label_radio6").html(result[5]);
                    $("#label_radio7").html(result[6]);
                    $("#label_radio8").html(result[7]);
                    $("#label_radio9").html(result[8]);
                    $("#label_radio10").html(result[9]);
                    $("#exp2").text("the least closest genre")

                    $("#sort").text("how much a genre matches your preferences");
                }else{
                    // flip the suggestion list if the condition is set as "exploration"
                    $("#Radios1").val(result[9]);
                    $("#Radios2").val(result[8]);
                    $("#Radios3").val(result[7]);

                    $("#Radios4").val(result[6]);
                    $("#Radios5").val(result[5]);
                    $("#Radios6").val(result[4]);
                    $("#Radios7").val(result[3]);
                    $("#Radios8").val(result[2]);
                    $("#Radios9").val(result[1]);


                    $("#label_radio1").html(result[9]);
                    $("#exp1").text("the most novel genre")
                    $("#label_radio2").html(result[8]);
                    $("#label_radio3").html(result[7]);

                    $("#label_radio4").html(result[6]);
                    $("#label_radio5").html(result[5]);
                    $("#label_radio6").html(result[4]);
                    $("#label_radio7").html(result[3]);
                    $("#label_radio8").html(result[2]);
                    $("#label_radio9").html(result[1]);
                    $("#exp2").text("the least novel genre")

                    $("#sort").text("how much a genre is novel to you");
                }



            }
            $(".hide-on-success").hide();
        }});

        $('.show-on-success').show();

        $("#action_submit").on( "click", function() {
            $(this).attr("href", "/explore_genre2?genre=" + $("input[type='radio'][name='genre']:checked").val());
        });


    </script>
{% endblock %}